<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfect Scrollbar Advanced Demo</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .demo-container {
            display: flex;
            gap: 20px;
            height: 90vh;
            padding: 20px;
        }
        
        .demo-section {
            flex: 1;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .demo-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .demo-controls {
            padding: 15px 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .control-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.2s ease;
        }
        
        .control-btn:hover {
            background: #5a6fd8;
        }
        
        .control-btn.secondary {
            background: #6c757d;
        }
        
        .control-btn.secondary:hover {
            background: #5a6268;
        }
        
        .demo-content {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        
        .feature-showcase {
            padding: 20px;
            background: #fff;
        }
        
        .feature-item {
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .feature-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .feature-desc {
            color: #6c757d;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .metrics-panel {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 12px;
            z-index: 100;
            min-width: 200px;
        }
        
        .metric-row {
            display: flex;
            justify-content: space-between;
            margin: 3px 0;
        }
        
        .scrollbar-info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 8px;
            padding: 15px;
            margin: 20px;
        }
        
        .scrollbar-info h3 {
            color: #1976d2;
            margin-bottom: 10px;
        }
        
        .scrollbar-info ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .scrollbar-info li {
            margin: 5px 0;
            color: #424242;
        }
        
        /* Author emoticon styles for demo */
        .author-emoticon {
            display: inline-block;
            margin-right: 8px;
            font-size: 16px;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <!-- Main Chat Demo -->
        <div class="demo-section">
            <div class="demo-header">
                <span>ğŸ“± Main Chat Interface</span>
                <span id="mainStatus">Ready</span>
            </div>
            
            <div class="demo-controls">
                <button class="control-btn" onclick="addMessages('main', 5)">5ê°œ ë©”ì‹œì§€</button>
                <button class="control-btn" onclick="addMessages('main', 10)">10ê°œ ë©”ì‹œì§€</button>
                <button class="control-btn" onclick="addLongMessage('main')">ê¸´ ë©”ì‹œì§€</button>
                <button class="control-btn secondary" onclick="scrollToTop('main')">ë§¨ ìœ„ë¡œ</button>
                <button class="control-btn secondary" onclick="scrollToBottom('main')">ë§¨ ì•„ë˜ë¡œ</button>
                <button class="control-btn secondary" onclick="clearMessages('main')">ì „ì²´ ì‚­ì œ</button>
            </div>
            
            <div class="demo-content">
                <div id="mainMetrics" class="metrics-panel">
                    <div class="metric-row"><span>ìŠ¤í¬ë¡¤ ìœ„ì¹˜:</span><span id="mainScrollPos">0</span></div>
                    <div class="metric-row"><span>ì»¨í…ì¸  ë†’ì´:</span><span id="mainContentHeight">0</span></div>
                    <div class="metric-row"><span>ì»¨í…Œì´ë„ˆ ë†’ì´:</span><span id="mainContainerHeight">0</span></div>
                    <div class="metric-row"><span>ì¸ í¬ê¸°:</span><span id="mainThumbSize">0</span></div>
                    <div class="metric-row"><span>í™œì„± ìƒíƒœ:</span><span id="mainActiveState">Inactive</span></div>
                </div>
                
                <div class="chatbox" id="mainChatbox">
                    <div class="welcome-message">
                        <div class="message-container ai">
                            <img src="images/ai-assistant.png" alt="AI avatar" class="avatar" />
                            <div class="message ai">
                                ğŸš€ Perfect Scrollbar ê³ ê¸‰ ê¸°ëŠ¥ ë°ëª¨ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!
                                <br><br>
                                <strong>ì£¼ìš” ê¸°ëŠ¥:</strong>
                                <br>â€¢ ìë™ ìˆ¨ê¹€/ë³´ì„ (Auto-hide)
                                <br>â€¢ ì •ë°€ ìŠ¤í¬ë¡¤ë§ (Precision scrolling)
                                <br>â€¢ ë¶€ë“œëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜ (Smooth animations)
                                <br>â€¢ ë“œë˜ê·¸ ì•¤ ë“œë¡­ (Drag & drop)
                                <br>â€¢ ë§ˆìš°ìŠ¤ íœ  ìµœì í™”
                                <br>â€¢ ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ìŠ¤
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Stream Chat Demo -->
        <div class="demo-section">
            <div class="demo-header">
                <span>ğŸŒŠ Stream Chat Interface</span>
                <span id="streamStatus">Ready</span>
            </div>
            
            <div class="demo-controls">
                <button class="control-btn" onclick="addMessages('stream', 5)">5ê°œ ë©”ì‹œì§€</button>
                <button class="control-btn" onclick="addMessages('stream', 10)">10ê°œ ë©”ì‹œì§€</button>
                <button class="control-btn" onclick="simulateStream()">ìŠ¤íŠ¸ë¦¼ ì‹œë®¬ë ˆì´ì…˜</button>
                <button class="control-btn secondary" onclick="scrollToTop('stream')">ë§¨ ìœ„ë¡œ</button>
                <button class="control-btn secondary" onclick="scrollToBottom('stream')">ë§¨ ì•„ë˜ë¡œ</button>
                <button class="control-btn secondary" onclick="clearMessages('stream')">ì „ì²´ ì‚­ì œ</button>
            </div>
            
            <div class="demo-content">
                <div id="streamMetrics" class="metrics-panel">
                    <div class="metric-row"><span>ìŠ¤í¬ë¡¤ ìœ„ì¹˜:</span><span id="streamScrollPos">0</span></div>
                    <div class="metric-row"><span>ì»¨í…ì¸  ë†’ì´:</span><span id="streamContentHeight">0</span></div>
                    <div class="metric-row"><span>ì»¨í…Œì´ë„ˆ ë†’ì´:</span><span id="streamContainerHeight">0</span></div>
                    <div class="metric-row"><span>ì¸ í¬ê¸°:</span><span id="streamThumbSize">0</span></div>
                    <div class="metric-row"><span>í™œì„± ìƒíƒœ:</span><span id="streamActiveState">Inactive</span></div>
                </div>
                
                <div id="streamChatDiv" style="flex: 1; overflow: hidden; background: #f4f4f4; position: relative;">
                    <div class="message bot" style="background: rgba(255,255,255,0.9); margin: 15px; padding: 15px; border-radius: 12px;">
                        ğŸŒŠ ìŠ¤íŠ¸ë¦¼ ì±„íŒ… Perfect Scrollbar ë°ëª¨
                        <br><br>
                        ì´ ì¸í„°í˜ì´ìŠ¤ëŠ” ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° ì±„íŒ…ì— ìµœì í™”ëœ ìŠ¤í¬ë¡¤ë°”ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.
                        <br><br>
                        <strong>ìŠ¤íŠ¸ë¦¼ íŠ¹í™” ê¸°ëŠ¥:</strong>
                        <br>â€¢ ë¹ ë¥¸ ìŠ¤í¬ë¡¤ ì‘ë‹µì„±
                        <br>â€¢ ì‹¤ì‹œê°„ ì»¨í…ì¸  ì—…ë°ì´íŠ¸
                        <br>â€¢ ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤ ì• ë‹ˆë©”ì´ì…˜
                        <br>â€¢ ìŠ¤íŠ¸ë¦¼ ìƒ‰ìƒ í…Œë§ˆ
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Features Info Panel -->
    <div class="scrollbar-info">
        <h3>ğŸ¯ Perfect Scrollbar ê³ ê¸‰ ê¸°ëŠ¥</h3>
        <div style="display: flex; gap: 20px;">
            <div style="flex: 1;">
                <strong>ğŸ¨ ì‹œê°ì  ê¸°ëŠ¥:</strong>
                <ul>
                    <li>ê·¸ë¼ë°ì´ì…˜ ìŠ¤í¬ë¡¤ë°” ë””ìì¸</li>
                    <li>í˜¸ë²„ ì‹œ í™•ëŒ€ íš¨ê³¼ (8px â†’ 10px â†’ 12px)</li>
                    <li>ë¶€ë“œëŸ¬ìš´ íˆ¬ëª…ë„ ì „í™˜</li>
                    <li>ì •ë°€ ìŠ¤í¬ë¡¤ ê°€ì´ë“œë¼ì¸</li>
                    <li>ë™ì  ê·¸ë¦¼ì íš¨ê³¼</li>
                </ul>
            </div>
            <div style="flex: 1;">
                <strong>âš¡ ê¸°ëŠ¥ì  íŠ¹ì§•:</strong>
                <ul>
                    <li>ìë™ ìˆ¨ê¹€/ë³´ì„ (1.5ì´ˆ í›„)</li>
                    <li>ë§ˆìš°ìŠ¤ íœ  ì†ë„ ìµœì í™”</li>
                    <li>ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì •ë°€ ì œì–´</li>
                    <li>ë ˆì¼ í´ë¦­ìœ¼ë¡œ ë¹ ë¥¸ ì´ë™</li>
                    <li>ë¶€ë“œëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜ (300ms)</li>
                </ul>
            </div>
            <div style="flex: 1;">
                <strong>ğŸ”§ ê¸°ìˆ ì  êµ¬í˜„:</strong>
                <ul>
                    <li>ë„¤ì´í‹°ë¸Œ JavaScript (jQuery ë¶ˆí•„ìš”)</li>
                    <li>requestAnimationFrame ìµœì í™”</li>
                    <li>CSS3 í•˜ë“œì›¨ì–´ ê°€ì†</li>
                    <li>ì´ë²¤íŠ¸ ì“°ë¡œí‹€ë§</li>
                    <li>ë©”ëª¨ë¦¬ íš¨ìœ¨ì  ê´€ë¦¬</li>
                </ul>
            </div>
        </div>
    </div>
    
    <script src="script.js"></script>
    <script>
        // Demo specific variables
        let mainScrollbarInstance = null;
        let streamScrollbarInstance = null;
        let messageCounter = 1;
        
        // Emoticons for variety
        const emoticons = ['ğŸ˜Š', 'ğŸ˜„', 'ğŸ˜†', 'ğŸ¤”', 'ğŸ˜', 'ğŸ™‚', 'ğŸ˜', 'ğŸ¥°', 'ğŸ˜‰', 'ğŸ˜‡', 'ğŸ¤—', 'ğŸ˜‹', 'ğŸ¤“', 'ğŸ˜Œ'];
        
        // Initialize demo
        document.addEventListener('DOMContentLoaded', function() {
            initializeDemoScrollbars();
            startMetricsUpdater();
        });
        
        function initializeDemoScrollbars() {
            const mainChatbox = document.getElementById('mainChatbox');
            const streamChatDiv = document.getElementById('streamChatDiv');
            
            if (mainChatbox && typeof PerfectScrollbar !== 'undefined') {
                mainScrollbarInstance = new PerfectScrollbar(mainChatbox, {
                    wheelSpeed: 0.8,
                    minScrollbarLength: 30,
                    scrollingThreshold: 1500,
                    theme: 'main'
                });
                document.getElementById('mainStatus').textContent = 'Active';
            }
            
            // Create stream scrollbar using the same class structure
            if (streamChatDiv) {
                // Apply similar structure for stream
                streamChatDiv.style.cssText += `
                    scroll-behavior: smooth;
                    scrollbar-width: thin;
                    scrollbar-color: #2b63e5 rgba(43, 99, 229, 0.1);
                `;
                
                streamScrollbarInstance = createStreamScrollbar(streamChatDiv);
                document.getElementById('streamStatus').textContent = 'Active';
            }
        }
        
        function createStreamScrollbar(element) {
            // Simplified stream scrollbar for demo
            element.addEventListener('scroll', () => {
                updateStreamMetrics();
            });
            
            return {
                scrollToBottom: () => {
                    element.scrollTo({
                        top: element.scrollHeight - element.clientHeight,
                        behavior: 'smooth'
                    });
                },
                scrollToTop: () => {
                    element.scrollTo({ top: 0, behavior: 'smooth' });
                },
                update: () => {
                    // Update scrollbar if needed
                }
            };
        }
        
        function addMessages(type, count) {
            const container = type === 'main' ? document.getElementById('mainChatbox') : document.getElementById('streamChatDiv');
            const isStream = type === 'stream';
            
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    const isUser = i % 2 === 0;
                    addSingleMessage(container, isUser, isStream);
                    
                    // Update scrollbars
                    if (type === 'main' && mainScrollbarInstance) {
                        mainScrollbarInstance.update();
                        mainScrollbarInstance.scrollToBottom();
                    } else if (type === 'stream' && streamScrollbarInstance) {
                        streamScrollbarInstance.update();
                        streamScrollbarInstance.scrollToBottom();
                    }
                }, i * 300);
            }
        }
        
        function addSingleMessage(container, isUser, isStream) {
            const messageEl = document.createElement('div');
            messageEl.style.cssText = `
                margin: 10px 15px;
                padding: 12px 16px;
                border-radius: 12px;
                max-width: 80%;
                ${isUser ? 
                    `background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; margin-left: auto; text-align: right;` : 
                    `background: rgba(255,255,255,0.9); color: #333; margin-right: auto;`
                }
                animation: fadeInUp 0.3s ease-out;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            `;
            
            const content = isUser ? 
                `<span class="author-emoticon">${emoticons[Math.floor(Math.random() * emoticons.length)]}</span>ì‚¬ìš©ì ë©”ì‹œì§€ ${messageCounter++}ë²ˆ` :
                `AI ì‘ë‹µ ë©”ì‹œì§€ ${messageCounter++}ë²ˆì…ë‹ˆë‹¤. Perfect Scrollbar í…ŒìŠ¤íŠ¸ ì¤‘ì…ë‹ˆë‹¤.`;
                
            messageEl.innerHTML = content;
            
            if (isStream) {
                messageEl.classList.add('message', isUser ? 'user' : 'bot');
            } else {
                messageEl.className = isUser ? 'message user' : 'message ai';
            }
            
            container.appendChild(messageEl);
        }
        
        function addLongMessage(type) {
            const container = type === 'main' ? document.getElementById('mainChatbox') : document.getElementById('streamChatDiv');
            const longText = `ì´ê²ƒì€ Perfect Scrollbarì˜ ê¸´ ë©”ì‹œì§€ ì²˜ë¦¬ ëŠ¥ë ¥ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•œ ë§¤ìš° ê¸´ ë©”ì‹œì§€ì…ë‹ˆë‹¤. 

Perfect ScrollbarëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê³ ê¸‰ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤:

1. ğŸ¨ ì‹œê°ì  ê°œì„ ì‚¬í•­:
   - ì•„ë¦„ë‹¤ìš´ ê·¸ë¼ë°ì´ì…˜ ë””ìì¸
   - í˜¸ë²„ ì‹œ ë™ì  í¬ê¸° ë³€ê²½
   - ë¶€ë“œëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼
   - ë°˜íˆ¬ëª… íš¨ê³¼ì™€ ê·¸ë¦¼ì

2. âš¡ ì„±ëŠ¥ ìµœì í™”:
   - í•˜ë“œì›¨ì–´ ê°€ì† í™œìš©
   - ë©”ëª¨ë¦¬ íš¨ìœ¨ì  ê´€ë¦¬
   - ì´ë²¤íŠ¸ ì“°ë¡œí‹€ë§
   - requestAnimationFrame ì‚¬ìš©

3. ğŸ¯ ì‚¬ìš©ì ê²½í—˜:
   - ì •ë°€í•œ ìŠ¤í¬ë¡¤ ì œì–´
   - ìë™ ìˆ¨ê¹€/ë³´ì„ ê¸°ëŠ¥
   - ì§ê´€ì ì¸ ë“œë˜ê·¸ ì•¤ ë“œë¡­
   - ë ˆì¼ í´ë¦­ìœ¼ë¡œ ë¹ ë¥¸ ì´ë™

ì´ ë©”ì‹œì§€ëŠ” ìŠ¤í¬ë¡¤ë°”ê°€ ê¸´ ì½˜í…ì¸ ë¥¼ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ì§€ ë³´ì—¬ì¤ë‹ˆë‹¤.`;
            
            addSingleMessage(container, true, type === 'stream');
            
            const messageEl = document.createElement('div');
            messageEl.style.cssText = `
                margin: 10px 15px;
                padding: 15px 20px;
                border-radius: 12px;
                background: rgba(255,255,255,0.95);
                color: #333;
                line-height: 1.6;
                white-space: pre-wrap;
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            `;
            messageEl.textContent = longText;
            container.appendChild(messageEl);
            
            // Update and scroll
            setTimeout(() => {
                if (type === 'main' && mainScrollbarInstance) {
                    mainScrollbarInstance.update();
                    mainScrollbarInstance.scrollToBottom();
                } else if (type === 'stream' && streamScrollbarInstance) {
                    streamScrollbarInstance.update();
                    streamScrollbarInstance.scrollToBottom();
                }
            }, 100);
        }
        
        function simulateStream() {
            const container = document.getElementById('streamChatDiv');
            const words = ['ì•ˆë…•í•˜ì„¸ìš”', 'ì‹¤ì‹œê°„', 'ìŠ¤íŠ¸ë¦¼', 'ì±„íŒ…', 'í…ŒìŠ¤íŠ¸', 'ì¤‘ì…ë‹ˆë‹¤', 'Perfect', 'Scrollbar', 'ê¸°ëŠ¥ì„', 'í™•ì¸í•´ë³´ì„¸ìš”'];
            
            let wordIndex = 0;
            let currentMessage = '';
            
            const messageEl = document.createElement('div');
            messageEl.style.cssText = `
                margin: 10px 15px;
                padding: 12px 16px;
                border-radius: 12px;
                background: rgba(255,255,255,0.9);
                color: #333;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                min-height: 20px;
            `;
            container.appendChild(messageEl);
            
            const streamInterval = setInterval(() => {
                if (wordIndex < words.length) {
                    currentMessage += words[wordIndex] + ' ';
                    messageEl.textContent = currentMessage;
                    wordIndex++;
                    
                    if (streamScrollbarInstance) {
                        streamScrollbarInstance.update();
                        streamScrollbarInstance.scrollToBottom();
                    }
                } else {
                    clearInterval(streamInterval);
                    messageEl.textContent = currentMessage + '(ìŠ¤íŠ¸ë¦¼ ì™„ë£Œ)';
                }
            }, 200);
        }
        
        function scrollToTop(type) {
            if (type === 'main' && mainScrollbarInstance) {
                mainScrollbarInstance.scrollToTop();
            } else if (type === 'stream' && streamScrollbarInstance) {
                streamScrollbarInstance.scrollToTop();
            }
        }
        
        function scrollToBottom(type) {
            if (type === 'main' && mainScrollbarInstance) {
                mainScrollbarInstance.scrollToBottom();
            } else if (type === 'stream' && streamScrollbarInstance) {
                streamScrollbarInstance.scrollToBottom();
            }
        }
        
        function clearMessages(type) {
            const container = type === 'main' ? document.getElementById('mainChatbox') : document.getElementById('streamChatDiv');
            const messages = container.querySelectorAll('.message, div[style*="margin: 10px"]');
            
            messages.forEach((msg, index) => {
                if (!msg.closest('.welcome-message')) {
                    setTimeout(() => {
                        msg.style.opacity = '0';
                        msg.style.transform = 'translateY(-10px)';
                        setTimeout(() => msg.remove(), 300);
                    }, index * 50);
                }
            });
            
            messageCounter = 1;
            
            setTimeout(() => {
                if (type === 'main' && mainScrollbarInstance) {
                    mainScrollbarInstance.update();
                } else if (type === 'stream' && streamScrollbarInstance) {
                    streamScrollbarInstance.update();
                }
            }, 2000);
        }
        
        function startMetricsUpdater() {
            setInterval(() => {
                updateMainMetrics();
                updateStreamMetrics();
            }, 100);
        }
        
        function updateMainMetrics() {
            if (mainScrollbarInstance) {
                const el = mainScrollbarInstance.contentElement;
                if (el) {
                    document.getElementById('mainScrollPos').textContent = Math.round(el.scrollTop);
                    document.getElementById('mainContentHeight').textContent = el.scrollHeight;
                    document.getElementById('mainContainerHeight').textContent = el.clientHeight;
                    document.getElementById('mainThumbSize').textContent = Math.round(mainScrollbarInstance.thumbYHeight || 0);
                    document.getElementById('mainActiveState').textContent = 
                        mainScrollbarInstance.element.classList.contains('ps--active-y') ? 'Active' : 'Inactive';
                }
            }
        }
        
        function updateStreamMetrics() {
            const streamDiv = document.getElementById('streamChatDiv');
            if (streamDiv) {
                document.getElementById('streamScrollPos').textContent = Math.round(streamDiv.scrollTop);
                document.getElementById('streamContentHeight').textContent = streamDiv.scrollHeight;
                document.getElementById('streamContainerHeight').textContent = streamDiv.clientHeight;
                document.getElementById('streamThumbSize').textContent = 'N/A';
                document.getElementById('streamActiveState').textContent = 'Native';
            }
        }
        
        // Add fadeInUp animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeInUp {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>